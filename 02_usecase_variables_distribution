-- USING A CTE AND FRONTENDEVENTLOG TABLE, FIND THE DISTRIBUTION OF USERS ACROSS THE NUMBER OF TIMES THE EMAIL LINK WAS CLICKED PER USER

-- WITH SUBQUERY
SELECT NUM_LINK_CLICKS,
       COUNT(USERID) AS NUM_USERS
       FROM (SELECT USERID,
                   COUNT(EVENTID) AS NUM_LINK_CLICKS
                   FROM FRONTENDEVENTLOG
                   WHERE EVENTID = 5
                   GROUP BY USERID)
       GROUP BY NUM_LINK_CLICKS



-- WITH CTE
WITH USERCLICK AS (SELECT USERID,
                   COUNT(EVENTID) AS NUM_LINK_CLICKS
                   FROM FRONTENDEVENTLOG
                   WHERE EVENTID = 5
                   GROUP BY USERID
)

SELECT NUM_LINK_CLICKS,
       COUNT(USERID) AS NUM_USERS
       FROM USERCLICK
       GROUP BY NUM_LINK_CLICKS
